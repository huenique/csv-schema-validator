# CSV Schema Validator

Automated CSV schema validation framework for preventing data regressions in scraper outputs

[![Python 3.13](https://img.shields.io/badge/python-3.13-blue.svg)](https://www.python.org/downloads/)

## Purpose

This framework ensures that CSV files generated by web scrapers maintain consistent structure and data formats. It automatically detects:

- **Missing required columns** - Catch when expected fields disappear
- **Extra unexpected columns** - Identify schema drift  
- **Data type violations** - Ensure proper formats (UUIDs, emails, datetimes, etc.)
- **Required field violations** - Detect missing mandatory data
- **Format inconsistencies** - Validate JSON arrays, URLs, boolean values

## Quick Start

### Installation

```bash
# Install from git submodule
git submodule add https://github.com/huenique/csv-schema-validator.git

pip install -e ./csv-schema-validator
```

### Usage

```bash
# Show schema information
csv-schema-validator info --schema-type seller
csv-schema-validator info --schema-type listing

# Validate CSV files
csv-schema-validator validate --schema-type seller --file Seller_rows.csv
csv-schema-validator validate --schema-type listing --file Listing_rows.csv
```

## Schema Support

### Seller CSV Schema (28 fields)

- Core seller identification (UUID, name, profile URLs)
- Contact information (email, phone, address)
- Ratings and verification status
- Administrative tracking fields
- Status flags (blacklisted, counterfeiter, priority)

### Listing CSV Schema (33 fields)  

- Product identification (UUID, title, images, SKU/ASIN)
- Pricing and inventory data
- Marketplace compliance status
- Timestamps and tracking information
- Brand and category associations

## Integration Examples

### Post-Scraper Validation

```bash
#!/bin/bash
# Add to your scraper's workflow

# Run your scraper
python scraper.py

# Validate outputs automatically
csv-schema-validator validate --schema-type seller --file Seller_rows.csv
csv-schema-validator validate --schema-type listing --file Listing_rows.csv

if [ $? -ne 0 ]; then
    echo "‚ùå Schema validation failed - please review data quality"
    exit 1
fi
```

## Development

### Running Tests

```bash
# Install development dependencies
uv sync --dev

# Run tests
uv run pytest

# Run with coverage
uv run pytest --cov=csv_schema_validator

# Type checking
uv run mypy csv_schema_validator/

# Code formatting
uv run black csv_schema_validator/
uv run flake8 csv_schema_validator/
```
